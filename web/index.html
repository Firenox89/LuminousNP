<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>LEDs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.alloyui.com/3.0.1/aui-css/css/bootstrap.min.css" rel="stylesheet">
    <meta name="theme-color" content="#fafafa">
    <script src="https://cdn.alloyui.com/3.0.1/aui/aui-min.js"></script>
</head>
<body>
<div class="container">
    <h2>Level</h2>
    <select class="form-control" id="levelSelect">
        <option value="0">All Levels</option>
        <option value="1">Level 1</option>
        <option value="2">Level 2</option>
        <option value="3">Level 3</option>
        <option value="4">Level 4</option>
    </select>

    <h2>Color</h2>
    <div id="myHsvPalette" style="padding-left: 10px;"></div>

    <h2>Effect</h2>
    <select class="form-control" id="effectSelect">
    </select>

    <h2>Action</h2>
    <button class="btn btn-primary" onclick="on();">On</button>
    <button class="btn btn-primary" onclick="off();">Off</button>
    <button class="btn btn-primary" onclick="fill();">Fill</button>
    <button class="btn btn-primary" onclick="effect();">Effect</button>
    <br><br>

    <script>
        const userAction = async () => {
            const response = await fetch('effects');
            const effectJson = await response.json();
            const effectSelect = document.getElementById('effectSelect');
            effectJson.forEach(effect => {
                effectSelect.options[effectSelect.options.length] = new Option(effect, effect);
            });
        };
        userAction();
        YUI().use('aui-color-picker-base', function (Y) {
            new Y.HSVPalette({controls: false, selected: '00FF00'}).render('#myHsvPalette');
        });

        function fill() {
            const level = document.getElementById("levelSelect").value;
            const color = document.getElementsByClassName("form-control hsv-value")[0].value;
            fetch('fill?level=' + level + "&color=" + color + "&white=0");
        }

        function effect() {
            const level = document.getElementById("levelSelect").value;
            const color = document.getElementsByClassName("form-control hsv-value")[0].value;
            const effect = document.getElementById("effectSelect").value;
            fetch('effect?level=' + level + "&effect=" + effect + "&color=" + color);
        }

        function off() {
            const level = document.getElementById("levelSelect").value;
            fetch('off?level=' + level);
        }
        function on() {
            const level = document.getElementById("levelSelect").value;
            fetch('on?level=' + level);
        }
    </script>
</div>
</body>
</html>
